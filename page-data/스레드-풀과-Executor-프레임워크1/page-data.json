{
    "componentChunkName": "component---src-template-post-tsx",
    "path": "/스레드-풀과-Executor-프레임워크1/",
    "result": {"data":{"allMarkdownRemark":{"nodes":[{"fields":{"slug":"/문자-인코딩/"},"timeToRead":10,"frontmatter":{"title":"[자바 고급2] 문자 인코딩","series":"자바 고급2"}},{"fields":{"slug":"/스레드-풀과-Executor-프레임워크2/"},"timeToRead":14,"frontmatter":{"title":"[자바 고급1] 스레드 풀과 Executor 프레임워크2","series":"자바 고급1"}},{"fields":{"slug":"/스레드-풀과-Executor-프레임워크1/"},"timeToRead":20,"frontmatter":{"title":"[자바 고급1] 스레드 풀과 Executor 프레임워크1","series":"자바 고급1"}},{"fields":{"slug":"/동시성-컬렉션/"},"timeToRead":9,"frontmatter":{"title":"[자바 고급1] 동시성 컬렉션","series":"자바 고급1"}},{"fields":{"slug":"/CAS-동기화와-원자적-연산/"},"timeToRead":14,"frontmatter":{"title":"[자바 고급1] CAS - 동기화와 원자적 연산","series":"자바 고급1"}},{"fields":{"slug":"/생산자-소비자-문제2/"},"timeToRead":11,"frontmatter":{"title":"[자바 고급1] 생산자 소비자 문제2","series":"자바 고급1"}},{"fields":{"slug":"/생산자-소비자-문제1/"},"timeToRead":14,"frontmatter":{"title":"[자바 고급1] 생산자 소비자 문제1","series":"자바 고급1"}},{"fields":{"slug":"/고급-동기화-concurrent-Lock/"},"timeToRead":11,"frontmatter":{"title":"[자바 고급1] 고급 동기화 - concurrent.Lock","series":"자바 고급1"}},{"fields":{"slug":"/동기화-synchronized/"},"timeToRead":7,"frontmatter":{"title":"[자바 고급1] 동기화 - synchronized","series":"자바 고급1"}},{"fields":{"slug":"/메모리-가시성/"},"timeToRead":5,"frontmatter":{"title":"[자바 고급1] 메모리 가시성","series":"자바 고급1"}},{"fields":{"slug":"/스레드-제어와-생명주기2/"},"timeToRead":11,"frontmatter":{"title":"[자바 고급1] 스레드 제어와 생명주기2","series":"자바 고급1"}},{"fields":{"slug":"/스레드-제어와-생명주기1/"},"timeToRead":12,"frontmatter":{"title":"[자바 고급1] 스레드 제어와 생명주기1","series":"자바 고급1"}},{"fields":{"slug":"/스레드-생성과-실행/"},"timeToRead":8,"frontmatter":{"title":"[자바 고급1] 스레드 생성과 실행","series":"자바 고급1"}},{"fields":{"slug":"/프로세스와-스레드-소개/"},"timeToRead":9,"frontmatter":{"title":"[자바 고급1] 프로세스와 스레드 소개","series":"자바 고급1"}},{"fields":{"slug":"/컬렉션-프레임워크-순회-정렬-전체-정리/"},"timeToRead":16,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - 순회, 정렬, 전체 정리","series":"자바 중급2"}},{"fields":{"slug":"/컬렉션-프레임워크-Map-Stack-Queue/"},"timeToRead":7,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - Map, Stack, Queue","series":"자바 중급2"}},{"fields":{"slug":"/컬렉션-프레임워크-Set/"},"timeToRead":6,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - Set","series":"자바 중급2"}},{"fields":{"slug":"/컬렉션-프레임워크-HashSet/"},"timeToRead":11,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - HashSet","series":"자바 중급2"}},{"fields":{"slug":"/컬렉션-프레임워크-Hash/"},"timeToRead":6,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - Hash","series":"자바 중급2"}},{"fields":{"slug":"/컬렉션-프레임워크-List/"},"timeToRead":17,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - List","series":"자바 중급2"}},{"fields":{"slug":"/컬렉션-프레임워크-LinkedList/"},"timeToRead":14,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - LinkedList","series":"자바 중급2"}},{"fields":{"slug":"/컬렉션-프레임워크-ArrayList/"},"timeToRead":15,"frontmatter":{"title":"[자바 중급2] 컬렉션 프레임워크 - ArrayList","series":"자바 중급2"}},{"fields":{"slug":"/제네릭2/"},"timeToRead":14,"frontmatter":{"title":"[자바 중급2] 제네릭2","series":"자바 중급2"}},{"fields":{"slug":"/제네릭1/"},"timeToRead":9,"frontmatter":{"title":"[자바 중급2] 제네릭1","series":"자바 중급2"}},{"fields":{"slug":"/예외처리2-실습/"},"timeToRead":17,"frontmatter":{"title":"[자바 중급1] 예외처리2 - 실습","series":"자바 중급1"}},{"fields":{"slug":"/예외처리1-이론/"},"timeToRead":12,"frontmatter":{"title":"[자바 중급1] 예외처리1 - 이론","series":"자바 중급1"}},{"fields":{"slug":"/중첩-클래스-내부-클래스2/"},"timeToRead":9,"frontmatter":{"title":"[자바 중급1] 중첩 클래스, 내부 클래스2","series":"자바 중급1"}},{"fields":{"slug":"/중첩-클래스-내부-클래스1/"},"timeToRead":11,"frontmatter":{"title":"[자바 중급1] 중첩 클래스, 내부 클래스1","series":"자바 중급1"}},{"fields":{"slug":"/날짜와-시간/"},"timeToRead":24,"frontmatter":{"title":"[자바 중급1] 날짜와 시간","series":"자바 중급1"}},{"fields":{"slug":"/열거형-enum/"},"timeToRead":7,"frontmatter":{"title":"[자바 중급1] 열거형-enum","series":"자바 중급1"}},{"fields":{"slug":"/래퍼-Class-클래스/"},"timeToRead":11,"frontmatter":{"title":"[자바 중급1] 래퍼, Class 클래스","series":"자바 중급1"}},{"fields":{"slug":"/String-클래스/"},"timeToRead":10,"frontmatter":{"title":"[자바 중급1] String 클래스","series":"자바 중급1"}},{"fields":{"slug":"/불변-객체/"},"timeToRead":7,"frontmatter":{"title":"[자바 중급1] 불변 객체","series":"자바 중급1"}},{"fields":{"slug":"/Object-클래스/"},"timeToRead":10,"frontmatter":{"title":"[자바 중급1] Object 클래스","series":"자바 중급1"}},{"fields":{"slug":"/다형성과-설계/"},"timeToRead":5,"frontmatter":{"title":"[자바 기본] 다형성과 설계","series":"자바 기본"}},{"fields":{"slug":"/다형성2/"},"timeToRead":10,"frontmatter":{"title":"[자바 기본] 다형성2","series":"자바 기본"}},{"fields":{"slug":"/다형성1/"},"timeToRead":8,"frontmatter":{"title":"[자바 기본] 다형성1","series":"자바 기본"}},{"fields":{"slug":"/상속/"},"timeToRead":7,"frontmatter":{"title":"[자바 기본] 상속","series":"자바 기본"}},{"fields":{"slug":"/final/"},"timeToRead":4,"frontmatter":{"title":"[자바 기본] final","series":"자바 기본"}},{"fields":{"slug":"/자바-메모리-구조와-static/"},"timeToRead":10,"frontmatter":{"title":"[자바 기본] 자바 메모리 구조와 static","series":"자바 기본"}},{"fields":{"slug":"/접근-제어자/"},"timeToRead":5,"frontmatter":{"title":"[자바 기본] 접근 제어자","series":"자바 기본"}},{"fields":{"slug":"/패키지/"},"timeToRead":6,"frontmatter":{"title":"[자바 기본] 패키지","series":"자바 기본"}},{"fields":{"slug":"/생성자/"},"timeToRead":6,"frontmatter":{"title":"[자바 기본] 생성자","series":"자바 기본"}},{"fields":{"slug":"/객체-지향-프로그래밍/"},"timeToRead":6,"frontmatter":{"title":"[자바 기본] 객체 지향 프로그래밍","series":"자바 기본"}},{"fields":{"slug":"/기본형과-참조형/"},"timeToRead":8,"frontmatter":{"title":"[자바 기본] 기본형과 참조형","series":"자바 기본"}},{"fields":{"slug":"/클래스와-데이터/"},"timeToRead":6,"frontmatter":{"title":"[자바 기본] 클래스와 데이터","series":"자바 기본"}},{"fields":{"slug":"/99클럽-day10/"},"timeToRead":2,"frontmatter":{"title":"[99클럽] 면접반 10일차","series":"면접"}},{"fields":{"slug":"/99클럽-day9/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 9일차","series":"면접"}},{"fields":{"slug":"/메서드/"},"timeToRead":8,"frontmatter":{"title":"[자바 입문] 메서드","series":"자바 입문"}},{"fields":{"slug":"/배열/"},"timeToRead":7,"frontmatter":{"title":"[자바 입문] 배열","series":"자바 입문"}},{"fields":{"slug":"/훈련/"},"timeToRead":3,"frontmatter":{"title":"[자바 입문] 훈련","series":"자바 입문"}},{"fields":{"slug":"/스코프-형변환/"},"timeToRead":5,"frontmatter":{"title":"[자바 입문] 스코프, 형변환","series":"자바 입문"}},{"fields":{"slug":"/반복문/"},"timeToRead":6,"frontmatter":{"title":"[자바 입문] 반복문","series":"자바 입문"}},{"fields":{"slug":"/조건문/"},"timeToRead":7,"frontmatter":{"title":"[자바 입문] 조건문","series":"자바 입문"}},{"fields":{"slug":"/99클럽-day8/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 8일차","series":"면접"}},{"fields":{"slug":"/책-관리-예제-백엔드-개발/"},"timeToRead":6,"frontmatter":{"title":"[스프링 입문] 책 관리 예제 - 백엔드 개발","series":"스프링"}},{"fields":{"slug":"/연산자/"},"timeToRead":6,"frontmatter":{"title":"[자바 입문] 연산자","series":"자바 입문"}},{"fields":{"slug":"/99클럽-day7/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 7일차","series":"면접"}},{"fields":{"slug":"/변수/"},"timeToRead":8,"frontmatter":{"title":"[자바 입문] 변수","series":"자바 입문"}},{"fields":{"slug":"/99클럽-day6/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 6일차","series":"면접"}},{"fields":{"slug":"/스프링-웹-개발-기초/"},"timeToRead":2,"frontmatter":{"title":"[스프링 입문] 스프링 웹 개발 기초","series":"스프링"}},{"fields":{"slug":"/프로젝트-환경설정/"},"timeToRead":5,"frontmatter":{"title":"[스프링 입문] 프로젝트 환경 설정","series":"스프링"}},{"fields":{"slug":"/Hello-World/"},"timeToRead":6,"frontmatter":{"title":"[자바 입문] Hello World","series":"자바 입문"}},{"fields":{"slug":"/99클럽-day5/"},"timeToRead":2,"frontmatter":{"title":"[99클럽] 면접반 5일차","series":"면접"}},{"fields":{"slug":"/99클럽-day4/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 4일차","series":"면접"}},{"fields":{"slug":"/Multi-Modules-프로젝트/"},"timeToRead":12,"frontmatter":{"title":"[Gradle] Multi Modules 프로젝트","series":"gradle"}},{"fields":{"slug":"/99클럽-day3/"},"timeToRead":3,"frontmatter":{"title":"[99클럽] 면접반 3일차","series":"면접"}},{"fields":{"slug":"/Core-Type에-대한-이해/"},"timeToRead":7,"frontmatter":{"title":"[Gradle] Core Type에 대한 이해","series":"gradle"}},{"fields":{"slug":"/99클럽-day2/"},"timeToRead":2,"frontmatter":{"title":"[99클럽] 면접반 2일차","series":"면접"}},{"fields":{"slug":"/Groovy-언어의-기본/"},"timeToRead":8,"frontmatter":{"title":"[Gradle] Groovy 언어의 기본","series":"gradle"}},{"fields":{"slug":"/99클럽-day1/"},"timeToRead":6,"frontmatter":{"title":"[99클럽] 면접반 1일차","series":"면접"}},{"fields":{"slug":"/Gradle-기본/"},"timeToRead":9,"frontmatter":{"title":"[Gradle] Gradle 기본","series":"gradle"}},{"fields":{"slug":"/중요한-것은-포기하지-않는-마음/"},"timeToRead":3,"frontmatter":{"title":"2025년 1분기 회고(feat. 중요한 것은 포기하지 않는 마음)","series":"일상 이야기"}},{"fields":{"slug":"/Gradle-Introduction/"},"timeToRead":4,"frontmatter":{"title":"[Gradle] Introduction","series":"gradle"}},{"fields":{"slug":"/IntelliJ-플러그인/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 플러그인","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-Git-Github/"},"timeToRead":3,"frontmatter":{"title":"[IntelliJ IDEA] Git & Github","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-디버깅/"},"timeToRead":3,"frontmatter":{"title":"[IntelliJ IDEA] 디버깅","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-리팩토링/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 리팩토링","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-자동완성/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 자동완성","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-검색/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 검색","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-포커스/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 포커스","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-코드-Edit/"},"timeToRead":4,"frontmatter":{"title":"[IntelliJ IDEA] 코드 Edit","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-소개/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 소개","series":"인텔리제이"}},{"fields":{"slug":"/2024년-주니어-개발자-회고록/"},"timeToRead":3,"frontmatter":{"title":"2024년 주니어 개발자 회고록","series":"일상 이야기"}},{"fields":{"slug":"/WDD/"},"timeToRead":1,"frontmatter":{"title":"WDD(Why-Driven-Development)","series":"생각정리"}},{"fields":{"slug":"/내가-개발자-커리어를-시작한-이유/"},"timeToRead":4,"frontmatter":{"title":"내가 개발자 커리어를 시작한 이유","series":"일상"}},{"fields":{"slug":"/블로그-이관-및-회고/"},"timeToRead":3,"frontmatter":{"title":"블로그 이관 및 회고","series":"일상 이야기"}},{"fields":{"slug":"/Spring-Boot-3.2.x-더-이상-바이트코드를-구문-분석하여-매개변수-이름을-추론하려고-시도하지-않습니다/"},"timeToRead":3,"frontmatter":{"title":"Spring Boot 3.2.x 더 이상 바이트코드를 구문 분석하여 매개변수 이름을 추론하려고 시도하지 않습니다.","series":"트러블 슈팅"}},{"fields":{"slug":"/라떼-개발자/"},"timeToRead":2,"frontmatter":{"title":"라떼 개발자","series":"생각정리"}},{"fields":{"slug":"/2023년-주니어-개발자-회고록/"},"timeToRead":5,"frontmatter":{"title":"2023년 주니어 개발자 회고록","series":"일상 이야기"}}],"group":[{"fieldValue":"gradle","totalCount":5},{"fieldValue":"면접","totalCount":10},{"fieldValue":"생각정리","totalCount":2},{"fieldValue":"스프링","totalCount":3},{"fieldValue":"인텔리제이","totalCount":9},{"fieldValue":"일상","totalCount":1},{"fieldValue":"일상 이야기","totalCount":4},{"fieldValue":"자바 고급1","totalCount":13},{"fieldValue":"자바 고급2","totalCount":1},{"fieldValue":"자바 기본","totalCount":12},{"fieldValue":"자바 입문","totalCount":9},{"fieldValue":"자바 중급1","totalCount":10},{"fieldValue":"자바 중급2","totalCount":10},{"fieldValue":"트러블 슈팅","totalCount":1}]},"markdownRemark":{"id":"aa7266bd-f274-5841-844a-2371deeac7b7","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVQoz6WRPQvCQAyG+///R6GKm6AndhIcrNaiXVzEaqVaPym9Xs67XuIgiEvFw2whPDxJXof+KOf7uD4cUWtLGJGIHpMA2PDdWpgBqRyNOfMVkTHmV/ilSW7QjfPF+hRnpVC1hVkb3Nxla54NVpczVw1bN8Co9TbJw7QIdsX+Wtk9DHklXU+3O6bXl66HIG1gIQTzIVrCNJSzCJWyzLnp0A/4CfW+SjF6WKSqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"배너 이미지\"\n        title=\"배너 이미지\"\n        src=\"/static/3189e9c0404650ccc6c5ffc998bc8717/2bef9/banner.png\"\n        srcset=\"/static/3189e9c0404650ccc6c5ffc998bc8717/6f3f2/banner.png 256w,\n/static/3189e9c0404650ccc6c5ffc998bc8717/01e7c/banner.png 512w,\n/static/3189e9c0404650ccc6c5ffc998bc8717/2bef9/banner.png 1024w,\n/static/3189e9c0404650ccc6c5ffc998bc8717/71c1d/banner.png 1536w,\n/static/3189e9c0404650ccc6c5ffc998bc8717/e8950/banner.png 2000w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>해당 블로그 글은 <a href=\"https://inf.run/6oSgn\">영한님의 인프런 강의</a>를 바탕으로 쓰여진 글입니다.</p>\n</blockquote>\n<h2>스레드를 직접 사용할 때의 문제점</h2>\n<p>실무에서 스레드를 직접 생성해서 사용하면 다음과 같은 3가지 문제가 있다.</p>\n<ul>\n<li>스레드 생성 시간으로 인한 성능 문제</li>\n<li>스레드 관리 문제</li>\n<li><code>Runnable</code> 인터페이스의 불편함</li>\n</ul>\n<h3>스레드 생성 시간으로 인한 성능 문제</h3>\n<p>스레드는 매우 무거운 객체이다. 왜 무거울까?</p>\n<ul>\n<li>메모리 할당: 각 스레드는 자신만의 호출 스택(call stack)을 가지고 있어야 한다. 이 호출 스택은 스레드가 실행되는 동안 사용하는 메모리 공간이다. 따라서 스레드를 생성할 때는 이 호출 스택을 위한 메모리를 할당해야 한다.</li>\n<li>운영체제 자원 사용: 스레드를 생성하는 작업은 운영체제 커널 수준에서 이루어지며, 시스템 콜(system call)을 통해 처리된다. 이는 CPU와 메모리 리소스를 소모하는 작업이다.</li>\n<li>운영체제 스케줄러 설정: 새로운 스레드가 생성되면 운영체제의 스케줄러는 이 스레드를 관리하고 실행 순서를 조정해야 한다. 이는 운영체제의 스케줄링 알고리즘에 따라 추가적인 오버헤드가 발생할 수 있다.</li>\n</ul>\n<blockquote>\n<p>✅ 참고</p>\n<p>스레드 하나는 보통 1MB정도의 크기를 가진다.</p>\n</blockquote>\n<p>스레드는 굉장히 무겁다. 이렇게 무거운데 만약 선착수 이벤트로 1000명에게 90% 쿠폰을 뿌리겠다고 해보자. 그러면 요청수에 따라 스레드를 다 만들면 시스템이 다운되는 지경까지도 이를 것이다. 그리고 혹여나 작업 시간보다 스레드 생성 시간이 더 오래 걸릴 수도 있는 것이다. 즉, 배보다 배꼽이 더 큰 상황이 될 수 있는 것이다.</p>\n<h3>스레드 관리 문제</h3>\n<p>서버의 CPU, 메모리 자원은 한정되어 있기 때문에, 스레드는 무한하게 만들 수 없다. 이런 문제를 해결하려면 우리 시스템이 버틸 수 있는, 최대 스레드의 수 까지만 스레드를 생성할 수 있게 관리해야 한다. 또한 만약에 어플리케이션을 종료할 때 안전한 종료로 스레드의 작업을 다 진행하고 종료하거나 인터럽트 요청으로 급하게 종료시킬 때도 이 스레드들이 무언가 어디에서 관리가 되어야 한다는 느낌이 올 것이다.</p>\n<h3><code>Runnable</code> 인터페이스의 불편함</h3>\n<ul>\n<li>반환 값이 없다: <code>run()</code> 메서드는 반환 값을 가지지 않는다. 따라서 실행 결과를 얻기 위해서는 별도의 메커니즘을 사용해야 한다. 쉽게 이야기해서 스레드의 실행 결과를 직접 받을 수 없다.</li>\n<li>예외 처리: <code>run()</code> 메서드는 체크 예외를 던질 수 없다. 체크 예외의 처리는 메서드 내부에서 처리해야 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.828125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAt0lEQVQoz62SWQqEMBBEc4csmk1Fyf2PGHkNHQbGYfzIR5FOL1VdGuOc6zNh3jR57//iJ6G19oswpdRzzj3GKPF5nr21Jvd1XaVGfhB+KhCHEAY5zdd19W3bhGDfd4lBrVUIyQHmDMxclmURFYaAbsRZSpEaYsQMQkQdYd1QCGnAAglUKaKsBDSRA9w5EVdhzQEhfLKswDLDODiOY1hmCfBo+c0fZlvAsJ66oX4qdTTt2ahLM/th3wxC/NAR5e6yAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image1\"\n        title=\"image1\"\n        src=\"/static/75376dfcd4ffa554b1b46aca85d10cc4/2bef9/01.png\"\n        srcset=\"/static/75376dfcd4ffa554b1b46aca85d10cc4/6f3f2/01.png 256w,\n/static/75376dfcd4ffa554b1b46aca85d10cc4/01e7c/01.png 512w,\n/static/75376dfcd4ffa554b1b46aca85d10cc4/2bef9/01.png 1024w,\n/static/75376dfcd4ffa554b1b46aca85d10cc4/71c1d/01.png 1536w,\n/static/75376dfcd4ffa554b1b46aca85d10cc4/27f8b/01.png 1730w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>즉 위의 문제를 해결하려면 스레드를 관리하는 공간이 필요하다. 이를 위해 자바는 스레드를 <strong>스레드 풀</strong>이라는 공간에서 관리한다.</p>\n<p>스레드는 스레드 풀에서 대기하며 쉰다. 그러다가 위의 요청처럼 다른 스레드에 의해 어떤 작업 요청이 들어오면 스레드 풀의 대기하는 스레드 중 하나가 <code>RUNNABLE</code>로 상태변경이 되면서 해당 작업을 실행할 것이다. 그리고 작업이 완료되면 <code>WAITING</code>상태로 변경하면서 다시 스레드 풀로 들어간다. 이런 과정으로 자바는 스레드를 관리한다.</p>\n<p>이렇게 스레드 풀이라는 개념을 사용하면 스레드를 재사용할 수 있어서, 재사용시 스레드의 생성 시간을 절약할 수 있다. 그리고 스레드 풀에서 스레드가 관리되기 때문에 필요한 만큼만 스레드를 만들 수 있고, 또 관리할 수 있다. 사실 스레드 풀이라는 것이 별것이 아니다. 그냥 컬렉션에 스레드를 보관하고 재사용할 수 있게 하면 된다. 하지만 스레드 풀에 있는 스레드는 처리할 작업이 없다면, 대기 상태로 관리해야 하고, 작업 요청이 오면 <code>RUNNABLE</code>상태로 변경해야 한다. 막상 구현하려고 하면 생각보다 매우 복잡하다는 사실을 알게될 것이다. 여기에 생산자 소비자 문제까지 겹친다. 잘 생각해보면 어떤 생산자가 작업(task)를 만들 것이고, 우리의 스레드 풀에 있는 스레드가 소비자가 되는 것이다. 이런 문제를 한방에 해결해주는 것이 바로 자바가 제공하는 Executor 프레임워크다.</p>\n<h2>Executor 프레임워크 소개</h2>\n<p>자바의 Executor 프레임워크는 멀티스레딩 및 병렬 처리를 쉽게 사용할 수 있도록 돕는 기능의 모음이다. 이 프레임워크는 작업 실행의 관리 및 스레드 풀 관리를 효율적으로 처리해서 개발자가 직접 스레드를 생성하고 관리하는 복잡함을 줄여준다.</p>\n<h3>Executor 프레임워크 주요 요소</h3>\n<h4>Executor 인터페이스</h4>\n<p>가장 기본적이고 단순한 작업을 실행하는 인터페이스로 이전 그림에서 thread-0가 스레드 풀에게 작업을 전달할 때 <code>Executor</code> 인터페이스의 <code>execute(Runnable runnable)</code>을 실행하면 된다. 인자로 <code>Runnable</code>이 들어가면 된다.</p>\n<h4>ExecutorService 인터페이스</h4>\n<p><code>ExecutorService</code>는 <code>Executor</code> 인터페이스를 확장해서 작업 제출과 제어 기능을 추가로 제공한다. 주요 메서드로는 <code>submit()</code>,<code>close()</code>가 있다. Executor 프레임워크를 사용할 때는 대부분 이 인터페이스를 사용한다. 기본 구현체로는 <code>ThreadPoolExecutor</code>가 있다.</p>\n<h3>로그 유틸 만들기</h3>\n<p>Executor 프레임워크의 상태를 확인하기 위한 로그 출력 유틸리티를 만들어두자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExecutorService</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadPoolExecutor</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ExecutorUtils</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">printState</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ExecutorService</span> executorService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>executorService <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">ThreadPoolExecutor</span> poolExecutor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">int</span> pool <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getPoolSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> active <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> queuedTasks <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">long</span> completedTask <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getCompletedTaskCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[pool = \"</span> <span class=\"token operator\">+</span> pool <span class=\"token operator\">+</span> <span class=\"token string\">\", active = \"</span> <span class=\"token operator\">+</span> active <span class=\"token operator\">+</span> <span class=\"token string\">\", \"</span> <span class=\"token operator\">+</span>\n                    <span class=\"token string\">\"queuedTasks = \"</span> <span class=\"token operator\">+</span> queuedTasks <span class=\"token operator\">+</span> <span class=\"token string\">\", completedTask = \"</span> <span class=\"token operator\">+</span> completedTask <span class=\"token operator\">+</span> <span class=\"token string\">\"]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span>executorService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">printState</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ExecutorService</span> executorService<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> taskName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>executorService <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">ThreadPoolExecutor</span> poolExecutor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">int</span> pool <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getPoolSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> active <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> queuedTasks <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">long</span> completedTask <span class=\"token operator\">=</span> poolExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">getCompletedTaskCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span>taskName <span class=\"token operator\">+</span> <span class=\"token string\">\" -> [pool = \"</span> <span class=\"token operator\">+</span> pool <span class=\"token operator\">+</span> <span class=\"token string\">\", active = \"</span> <span class=\"token operator\">+</span> active <span class=\"token operator\">+</span> <span class=\"token string\">\", \"</span> <span class=\"token operator\">+</span>\n                    <span class=\"token string\">\"queuedTasks = \"</span> <span class=\"token operator\">+</span> queuedTasks <span class=\"token operator\">+</span> <span class=\"token string\">\", completedTask = \"</span> <span class=\"token operator\">+</span> completedTask <span class=\"token operator\">+</span> <span class=\"token string\">\"]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span>taskName <span class=\"token operator\">+</span> <span class=\"token string\">\" -> \"</span> <span class=\"token operator\">+</span> executorService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>여기서 <code>pool</code>은 스레드 풀에 관리되는 스레드 수를 의미하며, <code>active</code>는 작업을 수행하는 스레드의 수를 뜻하고 <code>queuedTasks</code>는 큐에 대기중인 작업 수를 나타낸다. 마지막으로 <code>completedTask</code>는 완료 작업 숫자를 나타낸다.</p>\n<h2>ExecutorService 코드로 시작하기</h2>\n<p>간단한 예제로 <code>ExecutorService</code>를 알아보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">sleep</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RunnableTask</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Runnable</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> sleepMs <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">RunnableTask</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">RunnableTask</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> sleepMs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sleepMs <span class=\"token operator\">=</span> sleepMs<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">+</span> <span class=\"token string\">\" 시작\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span>sleepMs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">+</span> <span class=\"token string\">\" 완료\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code>Runnable</code> 인터페이스를 구현한 작업 클래스를 만들었다. 이 작업은 단순히 1초 대기하는 작업이다. 이제 사용하는 코드를 볼건데 기존과 다르게 <code>ExecutorService</code>를 사용해 볼 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExecutorService</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LinkedBlockingQueue</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadPoolExecutor</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TimeUnit</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExecutorUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">printState</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">sleep</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ExecutorBasicMain</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ThreadPoolExecutor</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MILLISECONDS</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedBlockingQueue</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"== 초기 상태 ==\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printState</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">RunnableTask</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"taskA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">RunnableTask</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"taskB\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">RunnableTask</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"taskC\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">RunnableTask</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"taskD\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"== 작업 수행 중 ==\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printState</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"== 작업 수행 완료 ==\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printState</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"== shutdown 완료 ==\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printState</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code>ThreadPoolExecutor(ExecutorService)</code>는 크게 2가지 요소로 구성되어 있다.</p>\n<ul>\n<li>스레드 풀: 스레드를 관리한다.</li>\n<li><code>BlockingQueue</code> : 작업을 보관한다. 생산자 소비자 문제를 해결하기 위해 단순한 큐가 아니라, <code>BlockingQueue</code>를 사용한다.</li>\n</ul>\n<p>생산자가 <code>es.execute(new RunnableTask(\"taskA\"))</code>를 호출하면, <code>RunnableTask(\"taskA\")</code> 인스턴스가 <code>BlockingQueue</code>에 보관된다.</p>\n<ul>\n<li>생산자: <code>es.execute(작업)</code> 를 호출하면 내부에서 <code>BlockingQueue</code> 에 작업을 보관한다. <code>main</code> 스레드가 생산자가 된다.</li>\n<li>소비자: 스레드 풀에 있는 스레드가 소비자이다. 이후에 소비자 중에 하나가 <code>BlockingQueue</code>에 들어있는 작업을 받아서 처리한다.</li>\n</ul>\n<h3>ThreadPoolExecutor 생성자</h3>\n<ul>\n<li><code>corePoolSize</code> : 스레드 풀에서 관리되는 기본 스레드의 수</li>\n<li><code>maximumPoolSize</code> : 스레드 풀에서 관리되는 최대 스레드 수</li>\n<li><code>keepAliveTime</code>,<code>TimeUnit unit</code> : 기본 스레드 수를 초과해서 만들어진 스레드가 생존할 수 있는 대기 시간이다. 이 시간 동안 처리할 작업이 없다면 초과 스레드는 제거된다.</li>\n<li><code>BlockingQueue workQueue</code> : 작업을 보관할 블로킹 큐</li>\n</ul>\n<p>위의 코드에서는 기본 스레드 수를 2개로 최대 스레드 수를 2개로 무한대기한 상태로 <code>LinkedBlockingQueue</code>를 만들어서 보관한다는 것이다. 이것을 좀 더 알기 쉽게 그림을 통해 살펴보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.8125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA60lEQVQoz42TVw6EMAxEcwJ67x9IiPsf0KvxaiID2SwfA3EyPHDB9X0vXddF9cYDVVUlrq5rXeAeEs7KslTFPABi7dq2FahpmqBwRljMN47jFwhynueSZZkqTVMV46Io/EMAYw9+K3imaXp+IWo1z7MMwyDcxwsBIpAA6gFkfbAJ4HEcsq6rxjzDVzH1GFCbQhPTTpLkkhYfskBbInqQmQIRhOpyF8y2CRwlpIkYZfJNYTdDsmNlZ27fd9m2zdfZd5lv4EzZNcyo6XmesizLZV6R/n1+NWVcOLx2zZh/CrtMzy+5fwbC38AA/AASrCp1D9R+kwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image2\"\n        title=\"image2\"\n        src=\"/static/07e46ba39e3104bbdf81f970178f4197/2bef9/02.png\"\n        srcset=\"/static/07e46ba39e3104bbdf81f970178f4197/6f3f2/02.png 256w,\n/static/07e46ba39e3104bbdf81f970178f4197/01e7c/02.png 512w,\n/static/07e46ba39e3104bbdf81f970178f4197/2bef9/02.png 1024w,\n/static/07e46ba39e3104bbdf81f970178f4197/71c1d/02.png 1536w,\n/static/07e46ba39e3104bbdf81f970178f4197/7ef4c/02.png 1748w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><code>ThreadPoolExecutor</code>를 생성한 시점에 스레드 풀에 스레드를 미리 만들어두지는 않는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.421875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA80lEQVQoz5WSV47DMAxEdQP33uACw/e/IIOnYBwtIG+Qj4FZh0PKrqoqq+v6Z4R9ssuyNNd1nTVNY23bPkJN/9X1fe/rHEWAAOQAW75UpGl656hHDUMANnFsJ7LzPG3bNlvX1WPfdzuO41aW57nN82zLsnifAVmW3RjH8UOIZAIQQ3pdl28MVdKkDYqi8D5DhGEY3oSQEaCAqfiQsQa+clIxTZNXKELlooR8IUmS5E+DvhCytlbWQHCvDGFsBSG8k87DCSAG2MQ5hSfUXZ5+B3Kso9cVWF1q9bCeEHXcKwZyrMIj6cWVQ32s1z2RhaTCt1oIX/k3FQa1d9z3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image3\"\n        title=\"image3\"\n        src=\"/static/b480422ce00d35c300e1aa6583818ea7/2bef9/03.png\"\n        srcset=\"/static/b480422ce00d35c300e1aa6583818ea7/6f3f2/03.png 256w,\n/static/b480422ce00d35c300e1aa6583818ea7/01e7c/03.png 512w,\n/static/b480422ce00d35c300e1aa6583818ea7/2bef9/03.png 1024w,\n/static/b480422ce00d35c300e1aa6583818ea7/71c1d/03.png 1536w,\n/static/b480422ce00d35c300e1aa6583818ea7/c830c/03.png 1754w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><code>main</code> 스레드가 <code>es.execute()</code>를 통하여 taskA부터 D까지를 호출한다. 즉, taskA부터 D까지 요청이 블로킹 큐로 전달된다. 최초의 작업이 들어오면 이때 작업을 처리하기 위해 스레드를 만든다. 예를 들어서 최초 작업인 taskA가 들어오는 시점에 스레드1을 생성하고, 다음 작업인 taskB가 들어오는 시점에 스레드2를 생성한다. 이런 방식으로 <code>corePoolSize</code>에 지정한 수 만큼 스레드를 스레드 풀에 만든다. 여기서는 2를 설정했으므로 2개까지 만든다. <code>corePoolSize</code>까지 스레드가 생성되고 나면, 이후에는 스레드를 생성하지 않고 앞서 만든 스레드를 재사용한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABaUlEQVQoz3VTW46EMAzjAju82tK0UGBAI75We//LeeUUWHYeH1bUNHUcEwrTtjDGwFqj8RnWGLRtq0gpYZ5niMhr7c5TSJrhJMB1HvYNjOsQpgVxSAh9j9gP8CH+r7EWMq9woUfhvKA9VZgd7XmmGgkBTdPAOYeu6/TOWqtEGjkJyZ1DYZzTRxxlHEfFNE0aH48HYoxKVFUVhmHA/X6H916JrpAQtUEmDAHLsigJH5FwXVc9Uw1VUSE95P3RoK7rExJ3Qp8mdN4jiGhnKt22TSMfUyEVkED2GpKThFFRVxjooRcUnL3eC45HVEJlzJGMChmZJ3j+qNDu4zR7RxaWZXkqOCIJaQOtocq8atk/Zy3CQch1aZqspj5GuOBo8HW7qfq+708/8yR5D3XtrEMhY95DKn23g0MasX3/YF6WM0fQr85LPvMrc5/p4d+fYl+2nz6GEDCmpMo+/U1XFM8E70gPH8/c9f6J8Bcefi7Wuu7IJgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image4\"\n        title=\"image4\"\n        src=\"/static/f680985011ffff3e6a43af94a678fef6/2bef9/04.png\"\n        srcset=\"/static/f680985011ffff3e6a43af94a678fef6/6f3f2/04.png 256w,\n/static/f680985011ffff3e6a43af94a678fef6/01e7c/04.png 512w,\n/static/f680985011ffff3e6a43af94a678fef6/2bef9/04.png 1024w,\n/static/f680985011ffff3e6a43af94a678fef6/71c1d/04.png 1536w,\n/static/f680985011ffff3e6a43af94a678fef6/c830c/04.png 1754w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>스레드 풀에 관리되는 스레드가 2개이므로 <code>pool=2</code>, 작업을 수행중인 스레드가 2개이므로 <code>active=2</code>, 큐에 대기중인 작업이 2개이므로 <code>queuedTasks=2</code>, 완료된 작업은 없으므로 <code>completedTasks=0</code>이 되는 것이다. 작업이 완료되면 스레드는 대기(<code>WAITING</code>) 상태로 스레드 풀에 대기한다. 그리고 반납된 스레드는 재사용된다. 마찬가지로 taskC와 taskD도 스레드1과 2가 처리를 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.8125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA60lEQVQoz42TVw6EMAxEcwJ67x9IiPsf0KvxaiID2SwfA3EyPHDB9X0vXddF9cYDVVUlrq5rXeAeEs7KslTFPABi7dq2FahpmqBwRljMN47jFwhynueSZZkqTVMV46Io/EMAYw9+K3imaXp+IWo1z7MMwyDcxwsBIpAA6gFkfbAJ4HEcsq6rxjzDVzH1GFCbQhPTTpLkkhYfskBbInqQmQIRhOpyF8y2CRwlpIkYZfJNYTdDsmNlZ27fd9m2zdfZd5lv4EzZNcyo6XmesizLZV6R/n1+NWVcOLx2zZh/CrtMzy+5fwbC38AA/AASrCp1D9R+kwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image2\"\n        title=\"image2\"\n        src=\"/static/07e46ba39e3104bbdf81f970178f4197/2bef9/02.png\"\n        srcset=\"/static/07e46ba39e3104bbdf81f970178f4197/6f3f2/02.png 256w,\n/static/07e46ba39e3104bbdf81f970178f4197/01e7c/02.png 512w,\n/static/07e46ba39e3104bbdf81f970178f4197/2bef9/02.png 1024w,\n/static/07e46ba39e3104bbdf81f970178f4197/71c1d/02.png 1536w,\n/static/07e46ba39e3104bbdf81f970178f4197/7ef4c/02.png 1748w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>마지막으로 <code>close()</code>를 호출하면 <code>ThreadPoolExecutor</code>가 종료된다. 이때 스레드 풀에 대기하는 스레드도 함께 제거된다.</p>\n<blockquote>\n<p>✅ 참고</p>\n<p>당연한 이야기지만 스레드가 스레드 풀에서 작업을 수행하면 당연히 상태는 <code>RUNNABLE</code>이 된다.</p>\n</blockquote>\n<blockquote>\n<p>✅ 참고</p>\n<p><code>close()</code>는 자바 19부터 지원되는 메서드이다. 만약 19 미만 버전을 사용한다면 <code>shutdown()</code>을 호출하자.</p>\n</blockquote>\n<h2>Runnable의 불편함</h2>\n<p><code>Runnable</code>은 반환 값을 받을 수 없고 <code>run()</code> 메서드에 체크 예외를 던질 수 없다는 문제가 있다. 그럼 이런 문제를 <code>Executor</code> 프레임워크는 어떻게 해결했을까? 일단 <code>Runnable</code>의 불편함을 예제를 통해 알아보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span>future</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Random</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">sleep</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RunnableMain</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">InterruptedException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">MyRunnable</span> task <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MyRunnable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Thread</span> thread <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Thread-1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        thread<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        thread<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">int</span> result <span class=\"token operator\">=</span> task<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result value = \"</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyRunnable</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Runnable</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">int</span> value<span class=\"token punctuation\">;</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Runnable 시작\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            value <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create value = \"</span> <span class=\"token operator\">+</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Runnable 완료\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위의 코드는 랜덤 값을 반환하는 단순한 로직인데 반환값을 받을 수 없으니 멤버 변수를 통하여 저장 후 외부에서 접근을 해야할 것이다. 이렇게 간단한 로직을 정말 복잡하게 작성되어서 불편한 감도 있다. <code>Executor</code> 프레임워크에서는 이런 문제를 <code>Future</code>와 <code>Callable</code>로 해결을 하였다.</p>\n<h2>Future1 - 소개</h2>\n<h3>Runnable과 Callable 비교</h3>\n<h4>Runnable</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Runnable</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li><code>Runnable</code>의 <code>run()</code>은 반환 타입이 <code>void</code>이다. 따라서 값을 반환할 수 없다.</li>\n<li>예외가 선언되어 있지 않다. 따라서 해당 인터페이스를 구현하는 모든 메서드는 체크 예외를 던질 수 없다.</li>\n</ul>\n<h4>Callable</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Callable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\">V</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li><code>Callable</code>의 <code>call()</code>은 반환 타입이 제네릭 <code>V</code> 이다. 따라서 값을 반환할 수 있다.</li>\n<li><code>throws Exception</code> 예외가 선언되어 있다. 따라서 해당 인터페이스를 구현하는 모든 메서드는 체크 예외인 <code>Exception</code>과 그 하위 예외를 모두 던질 수 있다.</li>\n</ul>\n<p>그러면 <code>Callable</code>과 <code>Future</code>을 사용하는 예제를 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span>future</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Random</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">sleep</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CallableMainV1</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ExecutionException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">InterruptedException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MyCallable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Integer</span> result <span class=\"token operator\">=</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result value = \"</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyCallable</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Callable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">Integer</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Callable 시작\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">int</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create value = \"</span> <span class=\"token operator\">+</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Callable 완료\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>여기서 처음 보은 것들이 몇개가 있다. 일단 <code>Executors.newFixedThreadPool()</code>이다. 해당 메서드의 파라미터 값으로는 스레드 개수를 적어주면 되는데 해당 스레드 개수를 예제처럼 적어주면 아래와 같은 코드가 되는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ThreadPoolExecutor</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MILLISECONDS</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedBlockingQueue</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>다음으로 <code>MyCallable</code>이라는 클래스를 보자. 해당 클래스는 <code>Runnable</code>대신에 <code>Callable</code>을 구현하였다. 이제서야 드디어 반환 값을 받을 수 있고 예외도 던질 수 있게 되었다. 그리고 이 <code>Callable</code> 구현체를 스레드 풀에게 전달하려면 기존 <code>execute()</code>대신에 <code>submit()</code>을 사용하면 된다. 해당 메서드의 파라미터로 <code>Callable</code> 구현체를 전달해주면 된다. 그리고 반환 값을 <code>get()</code>을 통하여 받을 수 있고 이 부분에서 체크예외가 던져지므로 주의해야 한다.</p>\n<h3>Executor 프레임워크 강점</h3>\n<p>요청 스레드가 결과를 받아야 하는 상황이라면, <code>Callable</code>을 사용한 방식은 <code>Runnable</code>을 사용하는 방식보다 훨씬 편리하다. 코드만 보면 복잡한 멀티스레드를 사용한다는 느낌보다는, 단순한 싱글 스레드 방식으로 개발한다는 느낌이 들 것이다. 우리가 스레드를 생성도 안 하고 <code>join</code>이나 <code>yield</code> 같은 것을 전혀 사용하지도 않았는데 스레드가 작업을 받아 수행도 정상적으로 된다. 복잡한 멀티스레드를 매우 편리하게 사용할 수 있는 것이 바로 Executor 프레임워크의 큰 강점이다.</p>\n<p>하지만 의문점이 존재한다. <code>future.get()</code>을 호출하는 요청 스레드(<code>main</code>)는 <code>future.get()</code>을 호출 했을 때 2가지 상황으로 나뉘게 된다.</p>\n<ul>\n<li><code>MyCallable</code> 작업을 처리하는 스레드 풀의 스레드가 작업을 완료했다.</li>\n<li><code>MyCallable</code> 작업을 처리하는 스레드 풀의 스레드가 아직 작업을 완료하지 못했다.</li>\n</ul>\n<p><code>future.get()</code> 을 호출했을 때 스레드 풀의 스레드가 작업을 완료했다면 반환 받을 결과가 있을 것이다. 그런데 아직 작업을 처리중이라면 어떻게 될까? 이런 의문도 들 것이다. 왜 결과를 바로 반환하지 않고, 불편하게 <code>Future</code>라는 객체를 대신 반환할까?</p>\n<h2>Future2 - 분석</h2>\n<p><code>Future</code>는 미래의 결과를 받을 수 있는 객체라는 뜻이다. 미래의 결과를 객체로 받는다? 이게 무슨말일까?</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MyCallable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li><code>submit</code>을 호출하면 <code>MyCallable</code> 인스턴스가 스레드 풀로 전달된다.</li>\n<li>이때 <code>submit()</code>은 <code>MyCallable.call()</code>이 반환하는 무작위 숫자 대신에 <code>Future</code>를 반환한다.</li>\n<li>왜 <code>Future</code>로 감쌀까? 이유를 생각해보면 단순할 것 같다. <code>get()</code> 메서드로 <code>main</code> 스레드는 대기상태가 된다. 만약 대기상태가 아니라 바로 호출한다면 스레드가 작업을 다 했다면 상관이 없겠지만 작업을 안 했다면 뭔가 이상한 값이 나올 것이다. 그래서 이것은 미래의 어느 시점에 작업이 다 될 것이라는 것을 명시하기 위해 <code>Future</code>로 반환 값을 감싼거라고 생각한다.</li>\n<li>따라서 결과를 즉시 받는 것은 불가능하다. 이런 이유로 <code>es.submit()</code>은 <code>MyCallable</code>의 결과를 반환하는 대신에 <code>MyCallable</code>의 결과를 나중에 받을 수 있는 <code>Futurue</code>라는 객체를 대신 제공한다.</li>\n<li>정리하면 <code>Future</code>는 전달한 작업의 미래이다. 이 객체를 통해 전달한 작업의 미래 결과를 받을 수 있다.</li>\n</ul>\n<p>그럼 예제를 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span>future</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Random</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">sleep</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CallableMainV2</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ExecutionException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">InterruptedException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"submit() 호출\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MyCallable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"future 즉시 반환, future = \"</span> <span class=\"token operator\">+</span> future<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"future.get() [블로킹] 메서드 호출 시작 -> main 스레드 WAITING\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Integer</span> result <span class=\"token operator\">=</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"future.get() [블로킹] 메서드 호출 완료 -> main 스레드 RUNNABLE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result value = \"</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"future 완료, future = \"</span> <span class=\"token operator\">+</span> future<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyCallable</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Callable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">Integer</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Callable 시작\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">int</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create value = \"</span> <span class=\"token operator\">+</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Callable 완료\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>기존 예제에서 상태를 더 확인하기 위해 로그를 좀 추가하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.59375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA5ElEQVQoz6WTWwqFMBBDuwTfb1DBD3H/+5vLGYjUinLBj1BnmqZpbENVVSaUZfkZQUJN01jXdZ8R6rp2d33f+6g6hnpy8TTftq2FYRgMTNPkDZxCYBSo2V1i8zzbOI43DjqBCcQAi4qicOR5blmWnTWL5GZZFhcUT1wXhAB0ZFxSr+tq+757n5o+AuLgVptJ2AWVDe60G6CPq9gFUF44krOLQwWbCkIQGUhYeSpnvpUhMZyCHO3tfsWZxn+VPC9/WYJv9xDitm12HIcLxFzmBL+H6Z1KX4xqLUAsnbu9lH+QbvKEH2FXKroPY8VYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image5\"\n        title=\"image5\"\n        src=\"/static/9ead37d6c75b53e39b30e29f867d28a2/2bef9/05.png\"\n        srcset=\"/static/9ead37d6c75b53e39b30e29f867d28a2/6f3f2/05.png 256w,\n/static/9ead37d6c75b53e39b30e29f867d28a2/01e7c/05.png 512w,\n/static/9ead37d6c75b53e39b30e29f867d28a2/2bef9/05.png 1024w,\n/static/9ead37d6c75b53e39b30e29f867d28a2/71c1d/05.png 1536w,\n/static/9ead37d6c75b53e39b30e29f867d28a2/764d0/05.png 1898w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><code>MyCallable</code> 인스턴스를 편의상 <code>taskA</code>라고 하겠다. 편의상 스레드풀에 스레드가 1개 있다고 가정하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.84375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABEElEQVQ4y42TWYrEMAxEfYTs+0Yggfzm/ndT89xUo4RkmI/Csi2VS4tDURSW57mxCn6Prb233/xCWZbWtq3Vdf0nmqb5l0+QUVVVXJ+Aj9S8+QCEBRGhNMuyn3SBM3yw8RnH0bquu6SJD49yHglhZuUCJEkS4QkhgHBZFhuGId6laRqBLz59338JYWclALXHcdi2baY7ADGkehgiCcC+EIJ5nu08T9v3PSqGXAoEziBFkQgfFaqo67rGQ9JRkA+EUAqV8msNISLVaZp+TfBFV7C6TgzZEKdJiV3WHHr4cWFPI6Te1xVFfj7jHPr2P4F76gshBP7XKPXLT9HXQamKfoe6ef+iivP78ETwhLfH7vgA9HVFopiu7REAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image6\"\n        title=\"image6\"\n        src=\"/static/1d4e2b4f10689fa96baa75a5de2114d3/2bef9/06.png\"\n        srcset=\"/static/1d4e2b4f10689fa96baa75a5de2114d3/6f3f2/06.png 256w,\n/static/1d4e2b4f10689fa96baa75a5de2114d3/01e7c/06.png 512w,\n/static/1d4e2b4f10689fa96baa75a5de2114d3/2bef9/06.png 1024w,\n/static/1d4e2b4f10689fa96baa75a5de2114d3/71c1d/06.png 1536w,\n/static/1d4e2b4f10689fa96baa75a5de2114d3/baa75/06.png 1746w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>요청 스레드는 <code>es.submit(taskA)</code>를 호출하고 있다고 하자. 그러면 <code>ExecutorService</code>는 전달한 <code>taskA</code>의 미래 결과를 알 수 있는 <code>Future</code> 객체를 생성한다.</p>\n<blockquote>\n<p><code>Future</code>는 인터페이스이다. 이때 생성되는 실제 구현체는 <code>FutureTask</code>이다.</p>\n</blockquote>\n<p>그리고 생성한 <code>Future</code> 객체 안에 <code>taskA</code>의 인스턴스를 보관한다. <code>Future</code>는 내부에 <code>taskA</code> 작업의 완료 여부와, 작업의 결과 값을 가진다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.9375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABCElEQVQoz42TWYrEQAxDc4Ts+wLZyE/ufzwPz6DGk87AfIh2l12SbFeSoiisLEtr29bqurZhGKzrOo+bpvFf8v9FogASCKZpsr7vPeZsnudfpFVVfZHEMyeEIDoScK0cMaDmDcolsBNIKQJ313U5aZ7nxngglyPVEUvUCaX+bGXbNrvv2/Z9d0KE13V1oSisLhlRooW8ETLPZVkccgcZF7Ms+yBNU7/vhM+WiWkTV6hq61zUcnAbQe6LEBUpxsII6jiPta8OUX4WPUE+ziyCcWhsTkhrb1uOBFzSAnHKKBiNiD4OKdZbim9Q4Pw4DjvP08ZxNHWk5xNr+Z/EN/XXF6DlaHnP+sjxA8pMLWDRvNr2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image7\"\n        title=\"image7\"\n        src=\"/static/3bd825b1628fae173e6245e7732cc53a/2bef9/07.png\"\n        srcset=\"/static/3bd825b1628fae173e6245e7732cc53a/6f3f2/07.png 256w,\n/static/3bd825b1628fae173e6245e7732cc53a/01e7c/07.png 512w,\n/static/3bd825b1628fae173e6245e7732cc53a/2bef9/07.png 1024w,\n/static/3bd825b1628fae173e6245e7732cc53a/71c1d/07.png 1536w,\n/static/3bd825b1628fae173e6245e7732cc53a/2d912/07.png 1772w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>그리고 이 <code>Future</code> 객체를 블로킹 큐에 담고 반환을 즉시 해준다. <code>Future</code>는 내부에 작업의 완료 여부와, 작업의 결과 값을 가진다. 작업이 완료되지 않았기 때문에 아직은 결과 값이 없다. 로그를 보면 현재 <code>Future</code>의 상태는 <code>Not Completed</code>이고 연관된 작업은 taskA라고 나온다.</p>\n<blockquote>\n<p><code>Future</code>의 구현체는 <code>FutureTask</code>이다.</p>\n</blockquote>\n<p>여기서 중요한 핵심이 있는데, 작업을 전달할 때 생성된 <code>Future</code>는 즉시 반환된다는 점이다. 생성한 <code>Future</code>를 즉시 반환하기 때문에 요청 스레드는 대기하지 않고, 자유롭게 본인의 다음 코드를 호출할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.15625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA5ElEQVQoz6WTWwqEMAxFXYLPqvgEERXc//Y6nEBKLCMdmI9r2np7TNKaNU3j27b9W845X9e1z7quCwuxqqoSE+M3j6rve09yAmTwzXAch9/3XWB5nss6/tjL/gcQlWXpi6IIEcN5ngKcpknWiMuyiF+9qnEcn0AmlKdxGAa/rqtAtm2TTBjP8ywe+3Ei/gC0IDK471s2a4msUzYwC3kF6otY9A3pHKjNzIIfJb8BY9kD0VbpPGRI8/WkfhUtoHzao+1SThZfbP0iY96x8bouOW3NKPZplIvNIyX7J6SUBPK3WKW8H6DGLQPakQWWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image8\"\n        title=\"image8\"\n        src=\"/static/9ed20fe08eb778346eee689382d0be54/2bef9/08.png\"\n        srcset=\"/static/9ed20fe08eb778346eee689382d0be54/6f3f2/08.png 256w,\n/static/9ed20fe08eb778346eee689382d0be54/01e7c/08.png 512w,\n/static/9ed20fe08eb778346eee689382d0be54/2bef9/08.png 1024w,\n/static/9ed20fe08eb778346eee689382d0be54/71c1d/08.png 1536w,\n/static/9ed20fe08eb778346eee689382d0be54/d3deb/08.png 1758w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>큐에 들어있는 <code>Future[taskA]</code>를 꺼내서 스레드 풀의 스레드1이 작업을 시작한다. 참고로 <code>Future</code>의 구현체인 <code>FutureTask</code>는 <code>Runnable</code> 인터페이스도 함께 구현하고 있다. 스레드1은 <code>FutureTask</code>의 <code>run()</code> 메서드를 수행한다. 그리고 <code>run()</code> 메서드가 <code>taskA</code>의 <code>call()</code> 메서드를 호출하고 그 결과를 받아서 처리한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.8125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABL0lEQVQoz52TSZKDMAxFfQNmTwQIBQWkWbDi/kdT6guLdlzZdC9+2QbpSd+DquuaRFU0/68Ug6qKmqZhYX4HxPNv+vKfgcYYcs7R8HyS95601vzNWHuNQdZacr79+JbGMBAAjNM0Udd1vEayEQWY1obK4MYKKAW2bcsBADrvudOyLNm6CGsICUVRXG6GgaFprJLuAAUQlvM8Z2VZxgCBpkBZx1KSZML+ADiOI9vf953meeZiv7b1vS3Ik+5F6jxPWpaFq8I+gtd1peM4qO97BgEIgNwCgKUjcXN3CMDj8biSjGH7AAOGIkgGJAbILeBtgjPn7qJKWpWTEyAKOeepqurPAwojd1vXHAfJOaj4UuqwT6jOXVjLawh7u20bvV4/7MgksRKn/vKsYqvScfpS3oBFLfzfBs+HAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image9\"\n        title=\"image9\"\n        src=\"/static/b98a65ed896139f7554409a57d74891c/2bef9/09.png\"\n        srcset=\"/static/b98a65ed896139f7554409a57d74891c/6f3f2/09.png 256w,\n/static/b98a65ed896139f7554409a57d74891c/01e7c/09.png 512w,\n/static/b98a65ed896139f7554409a57d74891c/2bef9/09.png 1024w,\n/static/b98a65ed896139f7554409a57d74891c/71c1d/09.png 1536w,\n/static/b98a65ed896139f7554409a57d74891c/912fc/09.png 1934w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>스레드1은 아직 작업이 완료 안되었다고 하자. 그런데 <code>main</code> 스레드에서 <code>get()</code> 메서드를 호출하였다. 그러면 요청 스레드는 대기상태에 빠진다. 참고로 <code>Future</code>에 대한 참조를 가지고 있기에 언제든지 본인이 필요할 때 <code>Future.get()</code>을 호출해서 <code>taskA</code> 작업의 미래 결과를 받을 수 있다. 지금은 작업 전이니 대기상태가 되는 것이다. 물론 완료 상태라면 작업의 결과 값을 반환받을 것이다.</p>\n<blockquote>\n<p>✅ 참고: 블로킹 메서드</p>\n<p><code>Thread.join()</code>,<code>Future.get()</code>과 같은 메서드는 스레드가 작업을 바로 수행하지 않고, 다른 작업이 완료될 때 까지 기다리게 하는 메서드이다. 이러한 메서드를 호출하면 호출한 스레드는 지정된 작업이 완료될 때까지 블록(대기)되어 다른 작업을 수행할 수 없다.</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.515625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA90lEQVQoz52TOQ6AMAwE8wTu+4YG6Pj/34LG0qIIUVEssRN7vU6My7LMgzRNDfL/gHwnpyxLX1WV2UVR+DzPf8HBKrJ93/2yLEbI3h84GUmS+GEYfNd1VulLJXtxHNvaNM1njOMAg1brurZAkigQRZEBmz3FtW3rp2myrjgL4fjoMVBKcJgYKuFc+3RCnoqzgkch1QgCx3H467r8eZ52DSomQIjyN5kRbtvmx3F8HoZ1nmcDPipQCKmS8TVmIpJvLWt0NDaooghAve5HyRASy8pdEqfJcOFgEgR4HBC2ib+u66McAqDYT8LwT3nbKO373qCW338YLd9mDRTQV+tOwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image10\"\n        title=\"image10\"\n        src=\"/static/5039db0bc54e1e2a82558d005728541c/2bef9/10.png\"\n        srcset=\"/static/5039db0bc54e1e2a82558d005728541c/6f3f2/10.png 256w,\n/static/5039db0bc54e1e2a82558d005728541c/01e7c/10.png 512w,\n/static/5039db0bc54e1e2a82558d005728541c/2bef9/10.png 1024w,\n/static/5039db0bc54e1e2a82558d005728541c/71c1d/10.png 1536w,\n/static/5039db0bc54e1e2a82558d005728541c/093ec/10.png 1930w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>그러다가 작업이 완료되면 반환 값을 <code>Future</code> 객체 안에 담는다. 그리고 상태를 완료로 변경한다. 다음으로 요청 스레드인 <code>main</code> 스레드를 깨운다. 즉, <code>RUNNABLE</code> 상태로 변경시키는 것이다.</p>\n<h3>Future가 필요한 이유</h3>\n<p>그런데 잘 생각해보면 한 가지 의문이 들 수 있다. <code>submit</code>에서 블로킹을 하나, <code>get</code>에서 블로킹 하나 마찬가지지 않을까? 차라리 <code>submit</code>에서 블로킹을 시키고 직접 반환 타입으로 받으면 편하지 않을까 싶다. 왜 <code>Future</code>가 필요한지 자세히 알아보자.</p>\n<h2>Future3 - 활용</h2>\n<p>1부터 100까지 더하는 것을 <code>ExecutorService</code>를 활용하여 멀티 스레드 프로그래밍으로 작성해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span>future</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SumTaskMainV2</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">InterruptedException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ExecutionException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">SumTask</span> task1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SumTask</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">SumTask</span> task2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SumTask</span><span class=\"token punctuation\">(</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future1 <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span>task1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future2 <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span>task2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Integer</span> sum1 <span class=\"token operator\">=</span> future1<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Integer</span> sum2 <span class=\"token operator\">=</span> future2<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"task1.result = \"</span> <span class=\"token operator\">+</span> sum1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"task2.result = \"</span> <span class=\"token operator\">+</span> sum2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">int</span> sumAll <span class=\"token operator\">=</span> sum1 <span class=\"token operator\">+</span> sum2<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"task1 + task2 = \"</span> <span class=\"token operator\">+</span> sumAll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"End\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SumTask</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Callable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">int</span> startValue<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> endValue<span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">SumTask</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> startValue<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> endValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startValue <span class=\"token operator\">=</span> startValue<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endValue <span class=\"token operator\">=</span> endValue<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">Integer</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"작업 시작\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> startValue<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> endValue<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                sum <span class=\"token operator\">+=</span> i<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"작업 완료 result = \"</span> <span class=\"token operator\">+</span> sum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code>Runnable</code>로 구현했다면 <code>join()</code>도 걸어줘야 하고 멤버 변수로 결과 값을 담아서 외부에서 꺼내야 했다. 또한 체크 예외에 대해 반드시 잡아주지 않아도 된다. 조금 더 간결해졌다.</p>\n<h2>Future4 - 이유</h2>\n<p>만약 <code>submit</code> 메서드를 호출할 때 반환 타입이 <code>Future</code> 타입이 아니라 원래 원하는 반환 타입으로 반환받는다고 보자. taskA를 <code>submit</code> 메서드로 스레드 풀에 전달하면 스레드가 이걸 받아 작업을 할 것이다. 근데 이 작업이 100초 걸린다고 해보자. 그러면 <code>main</code> 스레드는 100초를 기달렸다가 결과를 받고 다음 작업인 taskB를 시작한다. 해당 작업도 100초 걸린다고 해보자. 그러면 100초를 기달리고 결과를 받을 것이다. 즉 총 200초가 걸리는 아주 안 좋은 결과가 나온다. 마치 단일 스레드로 돌리는 것과 같다.</p>\n<p>만약 <code>Future</code>로 받으면 어떻게 될까? taskA가 <code>submit</code> 메서드를 호출하면 즉시 <code>Future</code>타입을 받는다. 그리고 바로 다음 작업인 taskB를 시행한다. 이것도 바로 <code>Future</code>타입으로 바로 받는다. 그 후에 <code>get()</code>을 통하여 동시에 taskA와 taskB를 실행할 수 있다. 그리고 100초 후에 두 결과 값을 받을 수 있는 것이다. 바로 반환값을 받는 것보다 2배 성능이 좋아졌다.</p>\n<p>이런 이유로 <code>Future</code> 타입으로 받는 것이다. 하지만 유의해야 할 점이 있다. 아래와 같이 작성하면 이것 또한 마치 단일 스레드로 돌리는 최악의 효과를 볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span>future</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SumTaskMainV2_Bad</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">InterruptedException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ExecutionException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">SumTask</span> task1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SumTask</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">SumTask</span> task2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SumTask</span><span class=\"token punctuation\">(</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future1 <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span>task1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Integer</span> sum1 <span class=\"token operator\">=</span> future1<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future2 <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span>task2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Integer</span> sum2 <span class=\"token operator\">=</span> future2<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"task1.result = \"</span> <span class=\"token operator\">+</span> sum1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"task2.result = \"</span> <span class=\"token operator\">+</span> sum2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">int</span> sumAll <span class=\"token operator\">=</span> sum1 <span class=\"token operator\">+</span> sum2<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"task1 + task2 = \"</span> <span class=\"token operator\">+</span> sumAll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"End\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SumTask</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Callable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">int</span> startValue<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> endValue<span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">SumTask</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> startValue<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> endValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startValue <span class=\"token operator\">=</span> startValue<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endValue <span class=\"token operator\">=</span> endValue<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">Integer</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"작업 시작\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> startValue<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> endValue<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                sum <span class=\"token operator\">+=</span> i<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"작업 완료 result = \"</span> <span class=\"token operator\">+</span> sum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위의 코드처럼 <code>submit</code>을 한 후 바로 <code>get</code>을 하면 <code>get</code> 시점에서 바로 블로킹이 되기 때문에 <code>main</code> 스레드가 100초를 기달려야 한다. 즉, 아까와 같은 효과가 나니 주의하자.</p>\n<p><code>Future</code>라는 개념이 없다면 결과를 받을 때 까지 요청 스레드는 아무일도 못하고 대기해야 한다. 따라서 다른 작업을 동시에 수행할 수도 없다. <code>Future</code>라는 개념 덕분에 요청 스레드는 대기하지 않고, 다른 작업을 수행할 수 있다. 예를 들어서 다른 작업을 더 요청할 수 있다. 그리고 모든 작업 요청이 끝난 다음에, 본인이 필요할 때 <code>Future.get()</code>을 호출해서 최종 결과를 받을 수 있다.</p>\n<p><code>Future</code>는 요청 스레드를 블로킹(대기) 상태로 만들지 않고, 필요한 요청을 모두 수행할 수 있게 해준다. 필요한 모든 요청을 한 다음에 <code>Future.get()</code>을 통해 블로킹 상태로 대기하며 결과를 받으면 된다. 이런 이유로 <code>ExecutorService</code>는 결과를 직접 반환하지 않고, <code>Future</code>를 반환한다.</p>\n<h2>Future5 - 정리</h2>\n<p><code>Future</code>는 작업의 미래 계산의 결과를 나타내며, 계산이 완료되었는지 확인하고, 완료될 때까지 기다릴 수 있는 기능을 제공한다.</p>\n<h3>주요 메서드</h3>\n<h4>boolean cancel(boolean mayInterruptIfRunning)</h4>\n<ul>\n<li><strong>기능</strong>: 아직 완료되지 않은 작업을 취소한다.</li>\n<li><strong>매개변수</strong>: <code>mayInterruptIfRunning</code>\n<ul>\n<li><code>cancel(true)</code> : <code>Future</code>를 취소 상태로 변경한다. 이때 작업이 실행중이라면 <code>Thread.interrupt()</code>를 호출해서 작업을 중단한다.</li>\n<li><code>cancel(false)</code> : <code>Future</code>를 취소 상태로 변경한다. 단 이미 실행 중인 작업을 중단하지는 않는다.</li>\n</ul>\n</li>\n<li><strong>반환값</strong>: 작업이 성공적으로 취소된 경우 <code>true</code>, 이미 완료되었거나 취소할 수 없는 경우 <code>false</code></li>\n<li><strong>설명</strong>: 작업이 실행 중이 아니거나 아직 시작되지 않았으면 취소하고, 실행 중인 작업의 경우 <code>mayInterruptIfRunning</code>이 <code>true</code>이면 중단을 시도한다.</li>\n<li>*<strong>참고</strong>: 취소 상태의 <code>Future</code>에 <code>Future.get()</code>을 호출하면 <code>CancellationException</code> 런타임 예외가 발생 한다.</li>\n</ul>\n<h4>boolean isCancelled()</h4>\n<ul>\n<li><strong>기능</strong>: 작업이 취소되었는지 여부를 확인한다.</li>\n<li><strong>반환값</strong>: 작업이 취소된 경우 <code>true</code>, 그렇지 않은 경우 <code>false</code></li>\n<li><strong>설명</strong>: 이 메서드는 작업이 <code>cancel()</code> 메서드에 의해 취소된 경우에 <code>true</code>를 반환한다.</li>\n</ul>\n<h4>boolean isDone()</h4>\n<ul>\n<li><strong>기능</strong>: 작업이 완료되었는지 여부를 확인한다.</li>\n<li><strong>반환값</strong>: 작업이 완료된 경우 <code>true</code>, 그렇지 않은 경우 <code>false</code></li>\n<li><strong>설명</strong>: 작업이 정상적으로 완료되었거나, 취소되었거나, 예외가 발생하여 종료된 경우에 <code>true</code>를 반환한다.</li>\n</ul>\n<h4>State state</h4>\n<ul>\n<li><strong>기능</strong>: <code>Future</code>의 상태를 반환한다. 자바 19부터 지원한다.\n<ul>\n<li><code>RUNNING</code> : 작업 실행 중</li>\n<li><code>SUCCESS</code> : 성공 완료</li>\n<li><code>FAILED</code> : 실패 완료</li>\n<li><code>CANCELLED</code> : 취소 완료</li>\n</ul>\n</li>\n</ul>\n<h4>V get()</h4>\n<ul>\n<li><strong>기능</strong>: 작업이 완료될 때까지 대기하고, 완료되면 결과를 반환한다.</li>\n<li><strong>반환값</strong>: 작업의 결과</li>\n<li><strong>예외</strong>\n<ul>\n<li><code>InterruptedException</code> : 대기 중에 현재 스레드가 인터럽트된 경우 발생</li>\n<li><code>ExecutionException</code> : 작업 계산 중에 예외가 발생한 경우 발생</li>\n</ul>\n</li>\n<li><strong>설명</strong>: 작업이 완료될 때까지 <code>get()</code>을 호출한 현재 스레드를 대기(블록킹)한다. 작업이 완료되면 결과를 반환한다.</li>\n</ul>\n<h4>V get(long timeout, TimeUnit unit)</h4>\n<ul>\n<li><strong>기능</strong>: <code>get()</code>과 같은데, 시간 초과되면 예외를 발생시킨다.</li>\n<li><strong>매개변수</strong>:\n<ul>\n<li><code>timeout</code> : 대기할 최대 시간</li>\n<li><code>unit</code>: <code>timeout</code> 매개변수의 시간 단위 지정</li>\n<li><strong>반환값</strong>: 작업의 결과</li>\n<li><strong>예외</strong>\n<ul>\n<li><code>InterruptedException</code> : 대기 중에 현재 스레드가 인터럽트된 경우 발생</li>\n<li><code>ExecutionException</code> : 계산 중에 예외가 발생한 경우 발생</li>\n<li><code>TimeoutException</code> : 주어진 시간 내에 작업이 완료되지 않은 경우 발생</li>\n</ul>\n</li>\n<li><strong>설명</strong>: 지정된 시간 동안 결과를 기다린다. 시간이 초과되면 <code>TimeoutException</code>을 발생시킨다.</li>\n</ul>\n</li>\n</ul>\n<h2>Future6 - 취소</h2>\n<p><code>cancel()</code>이 어떻게 동작하는지 예제 코드를 통하여 알아보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span>future</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">sleep</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FutureCancelMain</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> mayInterruptIfRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//    private static boolean mayInterruptIfRunning = false;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> future <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MyTask</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Future.state: \"</span> <span class=\"token operator\">+</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">state</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"future.cancel(\"</span> <span class=\"token operator\">+</span> mayInterruptIfRunning <span class=\"token operator\">+</span> <span class=\"token string\">\") 호출\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">boolean</span> cancelResult1 <span class=\"token operator\">=</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span>mayInterruptIfRunning<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Future.state: \"</span> <span class=\"token operator\">+</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">state</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"future.cancel(\"</span> <span class=\"token operator\">+</span> mayInterruptIfRunning <span class=\"token operator\">+</span> <span class=\"token string\">\") result: \"</span> <span class=\"token operator\">+</span> cancelResult1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Future result: \"</span> <span class=\"token operator\">+</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CancellationException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Future는 이미 취소되었습니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> <span class=\"token operator\">|</span> <span class=\"token class-name\">ExecutionException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyTask</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Callable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"작업 중: \"</span> <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">Thread</span><span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"인터럽트 발생\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string\">\"Interrupted\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">return</span> <span class=\"token string\">\"Completed\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code>cancel(true)</code>를 하면 <code>Future</code>의 상태를 취소로 변경한다. 그리고 작업중인 스레드들을 인터럽트를 호출하여 중단시킨다. 반면 <code>cancel(false)</code>로 변경하면 <code>Future</code>의 상태를 취소로 변경하는 것은 같으나 이미 실행 중인 작업은 중단을 안 시킨다. 이렇게 취소 상태가 된 <code>Future</code>에 <code>get()</code>을 호출하면 이미 취소가 된 상태라 값을 꺼내올 수 없으므로 <code>CancellationException</code>라는 런타임 예외가 발생한다.</p>\n<h2>Future7 - 예외</h2>\n<p><code>Future.get()</code>을 호출하면 작업의 결과값 뿐만 아니라, 작업 중에 발생한 예외도 받을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">thread<span class=\"token punctuation\">.</span>executor<span class=\"token punctuation\">.</span>future</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MyLogger</span><span class=\"token punctuation\">.</span><span class=\"token static\">log</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token import static\"><span class=\"token namespace\">util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ThreadUtils</span><span class=\"token punctuation\">.</span><span class=\"token static\">sleep</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FutureExceptionMain</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ExecutorService</span> es <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"작업 전달\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> future <span class=\"token operator\">=</span> es<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ExCallable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"future.get() 호출 시도, future.state(): \"</span> <span class=\"token operator\">+</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">state</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Integer</span> result <span class=\"token operator\">=</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result value = \"</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ExecutionException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"e = \"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Throwable</span> cause <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getCause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cause = \"</span> <span class=\"token operator\">+</span> cause<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        es<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ExCallable</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Callable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token class-name\">Integer</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Callable 실행, 예외 발생\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalArgumentException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ex!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>작업 클래스에서 일부러 예외를 던져보았다. 그러면 <code>Future</code>에서 예외를 담는다. 예외가 발생했으므로 <code>Future</code>의 상태는 <code>FAILED</code>가 된다. 그리고 <code>main</code>스레드는 <code>get()</code>을 호출한다. <code>Future</code>의 상태가 <code>FAILED</code>면 <code>ExecutionException</code> 예외를 던진다. 그러면 <code>catch</code> 블록으로 가서 <code>Future</code>에 담아둔 예외를 출력할 수 있다.</p>\n<h2>ExecutorService - 작업 컬렉션 처리</h2>\n<p><code>ExecutorService</code>는 여러 작업을 한 번에 편리하게 처리하는 <code>invokeAll()</code>,<code>invokeAny()</code> 기능을 제공한다.</p>\n<h3>invokeAll()</h3>\n<ul>\n<li><code>&#x3C;T> List&#x3C;Future&#x3C;T>> invokeAll(Collection&#x3C;? extends Callable&#x3C;T>> tasks) throws InterruptedException</code>\n<ul>\n<li>모든 <code>Callable</code> 작업을 제출하고, 모든 작업이 완료될 때까지 기다린다.</li>\n</ul>\n</li>\n<li><code>&#x3C;T> List&#x3C;Future&#x3C;T>> invokeAll(Collection&#x3C;? extends Callable&#x3C;T>> tasks, long timeout, TimeUnit unit) throws InterruptedException</code>\n<ul>\n<li>지정된 시간 내에 모든 <code>Callable</code> 작업을 제출하고 완료될 때까지 기다린다.</li>\n</ul>\n</li>\n</ul>\n<h3>invokeAny()</h3>\n<ul>\n<li><code>&#x3C;T> T invokeAny(Collection&#x3C;? extends Callable&#x3C;T>> tasks) throws InterruptedException, ExecutionException</code>\n<ul>\n<li>하나의 <code>Callable</code> 작업이 완료될 때까지 기다리고, 가장 먼저 완료된 작업의 결과를 반환한다.</li>\n<li>완료되지 않은 나머지 작업은 취소한다.</li>\n</ul>\n</li>\n<li><code>&#x3C;T> T invokeAny(Collection&#x3C;? extends Callable&#x3C;T>> tasks, long timeout, TimeUnit unit) throws InterruptedException, ExecutionException, TimeoutException</code>\n<ul>\n<li>지정된 시간 내에 하나의 <code>Callable</code> 작업이 완료될 때까지 기다리고, 가장 먼저 완료된 작업의 결과를 반환한다.</li>\n<li>완료되지 않은 나머지 작업은 취소한다.</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>잘못된 지식이 있을 경우 댓글로 남겨주시면 빠르게 반영하겠습니다!</p>\n</blockquote>","fields":{"slug":"/스레드-풀과-Executor-프레임워크1/"},"timeToRead":20,"frontmatter":{"title":"[자바 고급1] 스레드 풀과 Executor 프레임워크1","tags":["자바"],"date":"2025-05-17T23:18:27.000Z","image":{"publicURL":"/static/3189e9c0404650ccc6c5ffc998bc8717/banner.png"},"series":"자바 고급1"}}},"pageContext":{"id":"aa7266bd-f274-5841-844a-2371deeac7b7"}},
    "staticQueryHashes": ["2580406332","3810308631"]}
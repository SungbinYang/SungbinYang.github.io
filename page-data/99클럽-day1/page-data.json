{
    "componentChunkName": "component---src-template-post-tsx",
    "path": "/99클럽-day1/",
    "result": {"data":{"allMarkdownRemark":{"nodes":[{"fields":{"slug":"/연산자/"},"timeToRead":6,"frontmatter":{"title":"[자바 입문] 연산자","series":"자바"}},{"fields":{"slug":"/99클럽-day7/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 7일차","series":"면접"}},{"fields":{"slug":"/변수/"},"timeToRead":8,"frontmatter":{"title":"[자바 입문] 변수","series":"자바"}},{"fields":{"slug":"/99클럽-day6/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 6일차","series":"면접"}},{"fields":{"slug":"/스프링-웹-개발-기초/"},"timeToRead":2,"frontmatter":{"title":"[스프링 입문] 스프링 웹 개발 기초","series":"스프링"}},{"fields":{"slug":"/프로젝트-환경설정/"},"timeToRead":5,"frontmatter":{"title":"[스프링 입문] 프로젝트 환경 설정","series":"스프링"}},{"fields":{"slug":"/Hello-World/"},"timeToRead":6,"frontmatter":{"title":"[자바 입문] Hello World","series":"자바"}},{"fields":{"slug":"/99클럽-day5/"},"timeToRead":2,"frontmatter":{"title":"[99클럽] 면접반 5일차","series":"면접"}},{"fields":{"slug":"/99클럽-day4/"},"timeToRead":1,"frontmatter":{"title":"[99클럽] 면접반 4일차","series":"면접"}},{"fields":{"slug":"/Multi-Modules-프로젝트/"},"timeToRead":12,"frontmatter":{"title":"[Gradle] Multi Modules 프로젝트","series":"gradle"}},{"fields":{"slug":"/99클럽-day3/"},"timeToRead":3,"frontmatter":{"title":"[99클럽] 면접반 3일차","series":"면접"}},{"fields":{"slug":"/Core-Type에-대한-이해/"},"timeToRead":7,"frontmatter":{"title":"[Gradle] Core Type에 대한 이해","series":"gradle"}},{"fields":{"slug":"/99클럽-day2/"},"timeToRead":2,"frontmatter":{"title":"[99클럽] 면접반 2일차","series":"면접"}},{"fields":{"slug":"/Groovy-언어의-기본/"},"timeToRead":8,"frontmatter":{"title":"[Gradle] Groovy 언어의 기본","series":"gradle"}},{"fields":{"slug":"/99클럽-day1/"},"timeToRead":6,"frontmatter":{"title":"[99클럽] 면접반 1일차","series":"면접"}},{"fields":{"slug":"/Gradle-기본/"},"timeToRead":9,"frontmatter":{"title":"[Gradle] Gradle 기본","series":"gradle"}},{"fields":{"slug":"/중요한-것은-포기하지-않는-마음/"},"timeToRead":3,"frontmatter":{"title":"2025년 1분기 회고(feat. 중요한 것은 포기하지 않는 마음)","series":"일상 이야기"}},{"fields":{"slug":"/Gradle-Introduction/"},"timeToRead":4,"frontmatter":{"title":"[Gradle] Introduction","series":"gradle"}},{"fields":{"slug":"/IntelliJ-플러그인/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 플러그인","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-Git-Github/"},"timeToRead":3,"frontmatter":{"title":"[IntelliJ IDEA] Git & Github","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-디버깅/"},"timeToRead":3,"frontmatter":{"title":"[IntelliJ IDEA] 디버깅","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-리팩토링/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 리팩토링","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-자동완성/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 자동완성","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-검색/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 검색","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-포커스/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 포커스","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-코드-Edit/"},"timeToRead":4,"frontmatter":{"title":"[IntelliJ IDEA] 코드 Edit","series":"인텔리제이"}},{"fields":{"slug":"/IntelliJ-소개/"},"timeToRead":2,"frontmatter":{"title":"[IntelliJ IDEA] 소개","series":"인텔리제이"}},{"fields":{"slug":"/2024년-주니어-개발자-회고록/"},"timeToRead":3,"frontmatter":{"title":"2024년 주니어 개발자 회고록","series":"일상 이야기"}},{"fields":{"slug":"/WDD/"},"timeToRead":1,"frontmatter":{"title":"WDD(Why-Driven-Development)","series":"생각정리"}},{"fields":{"slug":"/내가-개발자-커리어를-시작한-이유/"},"timeToRead":4,"frontmatter":{"title":"내가 개발자 커리어를 시작한 이유","series":"일상"}},{"fields":{"slug":"/블로그-이관-및-회고/"},"timeToRead":3,"frontmatter":{"title":"블로그 이관 및 회고","series":"일상 이야기"}},{"fields":{"slug":"/Spring-Boot-3.2.x-더-이상-바이트코드를-구문-분석하여-매개변수-이름을-추론하려고-시도하지-않습니다/"},"timeToRead":3,"frontmatter":{"title":"Spring Boot 3.2.x 더 이상 바이트코드를 구문 분석하여 매개변수 이름을 추론하려고 시도하지 않습니다.","series":"트러블 슈팅"}},{"fields":{"slug":"/라떼-개발자/"},"timeToRead":2,"frontmatter":{"title":"라떼 개발자","series":"생각정리"}},{"fields":{"slug":"/2023년-주니어-개발자-회고록/"},"timeToRead":5,"frontmatter":{"title":"2023년 주니어 개발자 회고록","series":"일상 이야기"}}],"group":[{"fieldValue":"gradle","totalCount":5},{"fieldValue":"면접","totalCount":7},{"fieldValue":"생각정리","totalCount":2},{"fieldValue":"스프링","totalCount":2},{"fieldValue":"인텔리제이","totalCount":9},{"fieldValue":"일상","totalCount":1},{"fieldValue":"일상 이야기","totalCount":4},{"fieldValue":"자바","totalCount":3},{"fieldValue":"트러블 슈팅","totalCount":1}]},"markdownRemark":{"id":"478fea81-c2b3-5a13-96b1-a69c77dd022d","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAb0lEQVQoz93SsQ4BAQyH8d8RQvAUNt7ErXI32gwSYfcC3vpv6WCROLEwfGnaNF+btJAv86vCWTGvfEkWZFX1t4VNxR25kxvZkCO5kDM5VM9oiHBN9qQlW3IlHTmRfojwFZMaNiXjT4/SPG38P2/zAKQNzSHnyggQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"배너 이미지\"\n        title=\"배너 이미지\"\n        src=\"/static/28366a8bb8ec5fc0935c8bf35fa6d3d3/8c557/banner.png\"\n        srcset=\"/static/28366a8bb8ec5fc0935c8bf35fa6d3d3/6f3f2/banner.png 256w,\n/static/28366a8bb8ec5fc0935c8bf35fa6d3d3/01e7c/banner.png 512w,\n/static/28366a8bb8ec5fc0935c8bf35fa6d3d3/8c557/banner.png 700w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>📖 질문</p>\n<p>동시성 문제 해결</p>\n<p>동시성 문제란 무엇이며, 이를 해결하기 위한 기본적인 전략을 설명해주세요. 실제 운영 환경에 적용한 사례가 있다면 함께 설명해 주어도 좋습니다.</p>\n<p>힌트: 동시성은 다중 사용자/요청이 동시에 자원에 접근할 때 발생합니다. 락(lock), 큐(queue), 트랜잭션 격리 수준 등의 개념을 활용해 본 경험을 떠올려 보세요.</p>\n</blockquote>\n<h1>답변</h1>\n<h2>동시성 문제란?</h2>\n<p>동시성 문제란, 멀티 프로세스, 멀티 스레드 또는 사용자가 동시에 공유자원에 접근할 때 발생하는 데이터의 무결성 및 일관성 문제를 말합니다.</p>\n<blockquote>\n<p>✅ 공유자원이란?</p>\n<p>멀티 프로세스 또는 멀티 스레드 환경에서 동시에 접근이 가능한 자원을 말합니다. 대표적인 예시로는 코드 내의 전역변수, 메모리, 파일, DB Connection을 들 수 있습니다.</p>\n</blockquote>\n<p>그러면 동시성 문제가 왜 일어나는지에 대해 물어보실 수 있으실겁니다. 동시성 문제가 발생하는 원인은 <strong>상호 배제의 원칙</strong>을 안 지켰기 때문입니다.</p>\n<blockquote>\n<p>✅ 상호배제의 원칙이란?</p>\n<ul>\n<li>\n<p>2개 이상의 프로세스 혹은 스레드들이 동시에 임계구역에 있으면 안됩니다.</p>\n</li>\n<li>\n<p>어떤 프로세스 혹은 스레드도 임계구역에 진입하는 것이 무한정 지연 되면 안됩니다.</p>\n</li>\n<li>\n<p>임계구역 안에 있는 프로세스 혹은 스레드가 다른 프로세스 혹은 스레드의 임계구역 진입을 막을 수 있어야 합니다.</p>\n</li>\n<li>\n<p>프로세스들 혹은 스레드들이 각 프로세스들 혹은 스레드들의 처리 속도, 접근 방법, 상태에 대해 어떠한 가정을 하면 안됩니다.</p>\n</li>\n</ul>\n</blockquote>\n<h2>동시성 문제 유형</h2>\n<p>그러면 동시성의 문제유형은 어떤 것이 있는지 말씀드리겠습니다. 동시성의 문제유형은 아래와 같습니다.</p>\n<ul>\n<li>경쟁조건: 실행 순서에 따라 결과가 달라지는 현상</li>\n<li>데드락: 프로세스들 혹은 스레드들이 서로의 자원을 기다리면서 영원히 대기하는 상태</li>\n<li>라이브락: 프로세스들 혹은 스레드들이 계속 상태는 변하지만 진전이 없는 즉, 나아가지 못하는 상태</li>\n<li>기아상태: 특정 프로세스 혹은 스레드가 필요한 자원을 계속 할당받지 못하는 상태</li>\n</ul>\n<h2>동시성 문제 해결</h2>\n<p>그럼 이런 동시성 문제를 어떻게 해결하면 될 지 말씀드리겠습니다.</p>\n<h3>락 기반 문제 해결</h3>\n<h4>상호배제 메커니즘</h4>\n<p>상호배제 메커니즘을 이용하면 쉽게 동시성 문제를 해결 할 수 있습니다. 특히 자바에서는 <code>synchronized</code>라는 키워드를 이용하여 해결을 할 수 있습니다. 예시코드도 한번 작성해보았습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">void</span> <span class=\"token function\">transferMoney</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Account</span> from<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Account</span> <span class=\"token keyword\">to</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span> amount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    from<span class=\"token punctuation\">.</span><span class=\"token function\">debit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">to</span><span class=\"token punctuation\">.</span><span class=\"token function\">credit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">transferMoney</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Account</span> from<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Account</span> <span class=\"token keyword\">to</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span> amount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">synchronized</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        from<span class=\"token punctuation\">.</span><span class=\"token function\">debit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">to</span><span class=\"token punctuation\">.</span><span class=\"token function\">credit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>락 기법으로 해결</h4>\n<ul>\n<li>Reetrant Lock 활용</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ReentrantLock</span> lock <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReentrantLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">withdraw</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> amount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    lock<span class=\"token punctuation\">.</span><span class=\"token function\">lock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>balance<span class=\"token punctuation\">.</span><span class=\"token function\">compareTo</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            balance <span class=\"token operator\">=</span> balance<span class=\"token punctuation\">.</span><span class=\"token function\">subtract</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n        lock<span class=\"token punctuation\">.</span><span class=\"token function\">unlock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>Read-Write Lock 활용</li>\n</ul>\n<p>해당 락 방식은 읽기는 병렬로 쓰기는 단독으로 접근하게 하는 락 기법입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ReadWriteLock</span> readWriteLock <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReentrantReadWriteLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">BigDecimal</span> <span class=\"token function\">getBalance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    readWriteLock<span class=\"token punctuation\">.</span><span class=\"token function\">readLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> balance<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n        readWriteLock<span class=\"token punctuation\">.</span><span class=\"token function\">readLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">unlock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setBalance</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BigDecimal</span> newBalance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    readWriteLock<span class=\"token punctuation\">.</span><span class=\"token function\">writeLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        balance <span class=\"token operator\">=</span> newBalance<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n        readWriteLock<span class=\"token punctuation\">.</span><span class=\"token function\">writeLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">unlock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>분산 락 활용</li>\n</ul>\n<p>만약 단일 서버가 아닌 여러 서버에서 공유자원 접근정도를 조절하려면 해당 기법을 이용하면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">acquireLock</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> resourceId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> requestId<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> timeoutMillis<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token class-name\">Boolean</span><span class=\"token punctuation\">.</span><span class=\"token constant\">TRUE</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>\n        redisTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">opsForValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setIfAbsent</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string\">\"lock::\"</span> <span class=\"token operator\">+</span> resourceId<span class=\"token punctuation\">,</span> requestId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Duration</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofMillis</span><span class=\"token punctuation\">(</span>timeoutMillis<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>CAS</h3>\n<p>CAS는 동기화 없이 동시성 문제를 해결하는 낙관적 락 방식 기법입니다. 이 방식은 멀티스레드 환경에서 락 없이 공유자원의 일관성을 보장합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">AtomicInteger</span> counter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AtomicInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    counter<span class=\"token punctuation\">.</span><span class=\"token function\">incrementAndGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">boolean</span> <span class=\"token function\">compareAndSet</span><span class=\"token punctuation\">(</span>expectedValue<span class=\"token punctuation\">,</span> newValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>currentValue <span class=\"token operator\">==</span> expectedValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        currentValue <span class=\"token operator\">=</span> newValue<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>트랜잭션과 격리 수준 활용</h3>\n<p>흔히 웹 어플리케이션을 우리는 많이 사용하고 특히 스프링과 JPA를 이용한다면 트랜잭션을 통하여 격리수준을 설정하여 해당 문제를 해결 할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>isolation <span class=\"token operator\">=</span> <span class=\"token class-name\">Isolation</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SERIALIZABLE</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">transferMoney</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> fromId<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> toId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">BigDecimal</span> amount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">Account</span> from <span class=\"token operator\">=</span> accountRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>fromId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Account</span> <span class=\"token keyword\">to</span> <span class=\"token operator\">=</span> accountRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>toId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>from<span class=\"token punctuation\">.</span><span class=\"token function\">getBalance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">compareTo</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InsufficientBalanceException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    from<span class=\"token punctuation\">.</span><span class=\"token function\">debit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">to</span><span class=\"token punctuation\">.</span><span class=\"token function\">credit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    accountRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>from<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accountRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>❓ 트랜잭션 격리 수준</p>\n<p>트랜잭션 격리 수준이란, 여러 트랜잭션이 동시에 실행될 때 데이터 정합성과 일관성을 유지하기 위한 기준입니다.</p>\n<ul>\n<li>\n<p>READ UNCOMMITTED: 다른 트랜잭션이 커밋하지 않은 데이터도 읽을 수 있는 수준이며, 속도는 빠르지만 일관성이 낮고 Dirty Read가 발생합니다.</p>\n</li>\n<li>\n<p>READ COMMITTED: 다른 트랜잭션이 커밋한 데이터만 읽을 수 있으며 Non-Repeatable Read 문제가 발생 가능합니다.</p>\n</li>\n<li>\n<p>REPEATABLE READ: 트랜잭션 동안 읽은 데이터는 항상 동일하게 유지되며 팬텀 Read 발생이 가능합니다.</p>\n</li>\n<li>\n<p>SERIALIZABLE: 모든 트랜잭션이 순차적으로 실행되는것처럼 보이게 하며 모든 동시성 문제를 차단합니다. 단, 성능 이슈가 있습니다.</p>\n</li>\n</ul>\n</blockquote>\n<h3>동시성 컬렉션 활용</h3>\n<p>자바에서 제공해주는 동시성 컬렉션을 활용하여 해당 문제를 해결 할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ConcurrentHashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> userCache <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ConcurrentHashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ConcurrentLinkedQueue</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Request</span><span class=\"token punctuation\">></span></span> requestQueue <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ConcurrentLinkedQueue</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nuserCache<span class=\"token punctuation\">.</span><span class=\"token function\">compute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"userId\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> existingUser<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>existingUser <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        existingUser<span class=\"token punctuation\">.</span><span class=\"token function\">incrementLoginCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> existingUser<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>큐와 메세지 브로커 활용</h3>\n<p>만약 Kafka같은 메세지 브로커를 이용하여 동시성을 처리할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderService</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">KafkaTemplate</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">OrderEvent</span><span class=\"token punctuation\">></span></span> kafkaTemplate<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">OrderConfirmation</span> <span class=\"token function\">createOrder</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OrderRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        \n        <span class=\"token class-name\">String</span> orderId <span class=\"token operator\">=</span> <span class=\"token function\">generateOrderId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        kafkaTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"order-processing\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OrderEvent</span><span class=\"token punctuation\">(</span>orderId<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OrderConfirmation</span><span class=\"token punctuation\">(</span>orderId<span class=\"token punctuation\">,</span> <span class=\"token string\">\"주문이 접수되었습니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token annotation punctuation\">@KafkaListener</span><span class=\"token punctuation\">(</span>topics <span class=\"token operator\">=</span> <span class=\"token string\">\"order-processing\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">processOrder</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OrderEvent</span> event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 비즈니스 로직</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>ExecutorService</h3>\n<p>ExecutorService를 이용하여 스레드 풀 관리를 통해 해당 문제 또한 해결할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ReportGenerator</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ExecutorService</span> executor <span class=\"token operator\">=</span> <span class=\"token class-name\">Executors</span><span class=\"token punctuation\">.</span><span class=\"token function\">newFixedThreadPool</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 스레드 풀 관리 전략들이 다양함.</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">CompletableFuture</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Report</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">generateReportAsync</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReportRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">CompletableFuture</span><span class=\"token punctuation\">.</span><span class=\"token function\">supplyAsync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">generateReport</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> executor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">CompletableFuture</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token function\">generateAndEmailReport</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReportRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> email<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">generateReportAsync</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">thenApply</span><span class=\"token punctuation\">(</span>report <span class=\"token operator\">-></span> <span class=\"token function\">convertToPdf</span><span class=\"token punctuation\">(</span>report<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">thenApplyAsync</span><span class=\"token punctuation\">(</span>pdf <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n                emailService<span class=\"token punctuation\">.</span><span class=\"token function\">sendEmail</span><span class=\"token punctuation\">(</span>email<span class=\"token punctuation\">,</span> pdf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> pdf<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> executor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>불변 객체 활용</h3>\n<p>기본적으로 불변객체를 통해 새로운 객체를 반환하여 동시성 문제도 해결 시킬 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">// 불변 객체 설계</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Money</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Integer</span> amount<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Currency</span> currency<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Money</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Integer</span> amount<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Currency</span> currency<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>amount <span class=\"token operator\">=</span> amount<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currency <span class=\"token operator\">=</span> currency<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Money</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Money</span> otherMoney<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currency<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>otherMoney<span class=\"token punctuation\">.</span>currency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalArgumentException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"예외 발생\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Money</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>amount<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>otherMoney<span class=\"token punctuation\">.</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>실무 적용 사례</h3>\n<p>제가 실무에서 동시성 이슈가 발생한 적이 있었습니다. 바로 사내에 회의실 예약 시스템에서 해당 이슈가 발생이 되었습니다. 회의실 예약을 할 때 인기있던 시간대들이 있었는데 그 시간 대에 동시성 이슈가 빈번히 발생하는 현상을 모니터링으로 확인할 수 있었습니다. 저는 해당 부분에서 예약을 할 때 <strong>비관적 락</strong>기법을 이용하였습니다. 왜냐하면 일단 데이터에 대한 일관성이 매우 중요했고 해당 이슈를 해결하기 위한 기한이 짧아서 바로 생각나는 방법을 적용하였고 현재 해당 이슈를 해결한 경험이 있습니다. 다만, 제가 적용한 비관적 락 방식이 최선의 방법이 아닐 수 있지만 그 상황에서 실리적이고 최선의 방법이라 생각하였고 바로 적용하였습니다. 사내 코드이므로 일부 코드만 보여드리면 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ReservationRepository</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">JpaRepository</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Reservation</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token annotation punctuation\">@Query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT r FROM Reservation r WHERE r.room.id = :roomId \"</span> <span class=\"token operator\">+</span>\n           <span class=\"token string\">\"AND r.status = 'CONFIRMED' \"</span> <span class=\"token operator\">+</span>\n           <span class=\"token string\">\"AND ((r.startTime &lt;= :endTime AND r.endTime >= :startTime))\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Reservation</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findOverlappingReservations</span><span class=\"token punctuation\">(</span>\n            <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"roomId\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> roomId<span class=\"token punctuation\">,</span>\n            <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"startTime\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">LocalDateTime</span> startTime<span class=\"token punctuation\">,</span>\n            <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"endTime\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">LocalDateTime</span> endTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token annotation punctuation\">@Lock</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LockModeType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">PESSIMISTIC_WRITE</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@QueryHints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token annotation punctuation\">@QueryHint</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"javax.persistence.lock.timeout\"</span><span class=\"token punctuation\">,</span> value <span class=\"token operator\">=</span> <span class=\"token string\">\"3000\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@Query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT r FROM Reservation r WHERE r.room.id = :roomId \"</span> <span class=\"token operator\">+</span>\n           <span class=\"token string\">\"AND r.status = 'CONFIRMED' \"</span> <span class=\"token operator\">+</span>\n           <span class=\"token string\">\"AND ((r.startTime &lt;= :endTime AND r.endTime >= :startTime))\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Reservation</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findOverlappingReservationsWithLock</span><span class=\"token punctuation\">(</span>\n            <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"roomId\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> roomId<span class=\"token punctuation\">,</span>\n            <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"startTime\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">LocalDateTime</span> startTime<span class=\"token punctuation\">,</span>\n            <span class=\"token annotation punctuation\">@Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"endTime\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">LocalDateTime</span> endTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","fields":{"slug":"/99클럽-day1/"},"timeToRead":6,"frontmatter":{"title":"[99클럽] 면접반 1일차","tags":["면접"],"date":"2025-04-09T10:08:27.000Z","image":{"publicURL":"/static/28366a8bb8ec5fc0935c8bf35fa6d3d3/banner.png"},"series":"면접"}}},"pageContext":{"id":"478fea81-c2b3-5a13-96b1-a69c77dd022d"}},
    "staticQueryHashes": ["2580406332","3810308631"]}